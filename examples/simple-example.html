<!DOCTYPE html>
<html>
  <head>
    <title>Simple example</title>
      <link rel="stylesheet" href="../bower_components/ionic/release/css/ionic.css" />
  </head>

  <body ng-app="examples">

    <ion-header-bar align-title="left" class="bar-positive">
      <h1 class="title">Simple example</h1>
    </ion-header-bar>

    <ion-content class="has-header" ng-controller="SimpleExampleCtrl as vm">
      <div class="list">
        <div class="item item-divider">
          Form
        </div>
          <div class="item">
            The form is <em ng-show="ngForm.$pristine">pristine</em><em ng-show="ngForm.$dirty">dirty</em>
            and <em ng-show="ngForm.$valid">valid</em><em ng-show="!ngForm.$valid">invalid</em>
          </div>
        <div class="item">
          <form name="ngForm"
                class="list list-inset"
                sf-schema="vm.schemaFormData.schema"
                sf-form="vm.schemaFormData.form"
                sf-model="vm.model">
          </form>
        </div>

        <div class="item item-divider">
          Model
        </div>
        <div class="item">
          <pre><code>{{vm.prettyModel}}</code></pre>
        </div>
      </div>
    </ion-content>

    <script type="text/javascript" src="../bower_components/ionic/release/js/ionic.bundle.js"></script>
    <script type="text/javascript" src="../bower_components/angular-sanitize/angular-sanitize.min.js"></script>
    <script type="text/javascript" src="../bower_components/tv4/tv4.js"></script>
    <script type="text/javascript" src="../bower_components/objectpath/lib/ObjectPath.js"></script>
    <script type="text/javascript" src="../bower_components/angular-schema-form/dist/schema-form.js"></script>
    <script type="text/javascript" src="../dist/ionic-decorator.js"></script>

    <script>
      angular
        .module('examples', ['schemaForm'])
        .controller('SimpleExampleCtrl', SimpleExampleCtrl);

      SimpleExampleCtrl.$inject = ['$scope', '$q', '$timeout'];
      function SimpleExampleCtrl($scope, $q, $timeout) {
        var vm = this;

        vm.model = {
                    "inventoryItemList": [
                    {
                        "jdeItemNumber": "15513F",
                        "description": "10M POWER CABLE FOR OMS840",
                        "plannedQuantity": 12,
                        "wmskey": "SOPR010824",
                        "isPlannedItem": true,
                        "reasonForVariation": "",
                        "hasStock": false,
                        "actualQuantity": 0
                    },
                    {
                        "jdeItemNumber": "26335F",
                        "actualQuantity": 0,
                        "description": "CABLE CU 400/0.40 CPFUT MBHJSJ",
                        "wmskey": "26335F",
                        "isPlannedItem": false,
                        "category": "CAB",
                        "subcategory": "COP",
                        "reasonForVariation": "",
                        "hasStock": false
                    },
                    {
                        "jdeItemNumber": "26254F",
                        "actualQuantity": 0,
                        "description": "CABLE CU 100/0.64 CPFUT MBHJCB",
                        "wmskey": "26254F",
                        "isPlannedItem": false,
                        "category": "CAB",
                        "subcategory": "COP",
                        "reasonForVariation": "",
                        "hasStock": false
                    },
                    ],
                  };
        vm.schemaFormData = {
            "schema": {
                "title": "Inventory items",
                "type": "object",
                "properties": {
                    "inventoryItemList": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "jdeItemNumber": {
                                    "title": "Item number",
                                    "type": "string",
                                    "readonly": true
                                },
                                "description": {
                                    "title": "Description",
                                    "type": "string",
                                    "readonly": true
                                },
                                "plannedQuantity": {
                                    "title": "Planned quantity",
                                    "type": "integer",
                                    "readonly": true
                                },
                                "actualQuantity": {
                                    "title": "Actual quantity",
                                    "type": "integer"
                                },
                                "hasStock": {
                                    "title": "Do you have access to the inventory required?",
                                    "type": "boolean"
                                },
                                "reasonForVariation": {
                                    "title": "Reason for variation",
                                    "type": "string"
                                },
                                "wmskey": {
                                    "title": "WMS Key",
                                    "type": "string"
                                },
                                "isPlannedItem": {
                                    "title": "Is planned item",
                                    "type": "boolean"
                                }
                            },
                            "required": [
                                "actualQuantity"
                            ]
                        }
                    }
                }
            },
            'form': [
                {
                    "title": "Materials",
                    "key": "inventoryItemList",
                    "notitle": true,
                    "add": null,
                    "items": [
                        {
                            "key": "inventoryItemList[].jdeItemNumber",
                        },
                        {
                            "key": "inventoryItemList[].description",
                        },
                        {
                            "key": "inventoryItemList[].plannedQuantity",
                        },
                        {
                            "key": "inventoryItemList[].actualQuantity",
                        },
                        {
                            "key": "inventoryItemList[].hasStock",
                            "type": "checkbox",
                        },
                        {
                            "key": "inventoryItemList[].reasonForVariation",
                            "type": "textarea",
                        },
                        {
                            "key": "inventoryItemList[].wmskey",
                            "notitle": true,
                            "htmlClass": "ng-hide"
                        },
                    ]
                }
            ]
        };

        activate();

        function activate() {
          // Re-render `prettyModel` every time the `model` changes
          $scope.$watch('vm.model', function(value){
            if (value) {
              vm.prettyModel = JSON.stringify(value, undefined, 2);
            }
          }, true);

        }
      };

    </script>

  </body>
</html>
